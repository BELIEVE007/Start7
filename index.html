<section id="loginPage" class="loginSection" *ngIf="!register">
  <div class="row">
      <div class="col-md-4 offset-4 ">
          <h1>Login</h1>

          <form [formGroup]="loginForm" (ngSubmit)="login()" class="form">
              <div class="form-group">
                  <label>Contact Number<span class="text-danger">*</span></label>        
                  <input type="number" formControlName="contactNumber" id="contactNumber" class="form-control"> 
                  <span class="error-message" *ngIf="loginForm.get('contactNumber').invalid && loginForm.get('contactNumber').touched" class="text-danger">Enter the valid registered number</span>
              </div>

              <div class="form-group">
                  <label>Password<span class="text-danger">*</span></label>        
                  <input type="password" formControlName="password" id="uPass"class="form-control"> 
                  <span class="error-message" *ngIf="loginForm.get('password').invalid && loginForm.get('password').touched" class="text-danger">Enter a valid password</span>
                  <br>
                 
              </div>
               <!-- added a div class & anchor tag to show the Forgot password in login form -->
               <div class="form-group">
                   <a class="text-center" (click)="getitenary()">Forgot password?</a>
                </div>
              <span><span class="text-danger">*</span> marked fields are mandatory</span>
              <br>
              <div class="form-group">
                  <div *ngIf="errorMessage!=null" class="text-danger">
                      <h6>{{errorMessage}}</h6>
                  </div>
              </div>

              <button type="submit" [disabled]="loginForm.invalid" class="btn btn-primary">Login</button>   
          </form>
          <br>
          <!--can be a button or a link based on need -->
          <button class="btn btn-primary" (click)="getRegisterPage()">Click here to Register</button>
      </div>
    </div>
    <p-dialog header="Reset Password" *ngIf="showItenary" [(visible)]="showItenary" 
    [modal]="true" [responsive]="true" 
    [maximizable]="true" [baseZIndex]="10000" width="750" class="dialog-box">
     <input class ="form-control" type="text" placeholder="Enter Registered Number" #contactnum>
     <span class="text-danger" *ngIf="!contactVal">{{errorMessage2}}</span>
     <span class="text-success" *ngIf="contactVal">Number Validated Successfully</span>  
     <br><br>
     <button class="btn btn-primary" (click)="getContact(contactnum.value)">VALIDATE PHONE NUMBER</button><br><br>
     <div *ngIf="contactVal">
         <label style="font-family:cambria;" for="newPassword"><b>Enter new password</b></label><br>
         <input class="form-control" type="password" id="newPassword"  #newPassword><br>
         <label style="font-family:cambria; "for="rePassword"><b>Re-Enter new password & press Enter</b></label><br>
         <input class ="form-control" type="password" id="rePassword" #rePassword>
         <span class="text-danger" *ngIf="mismatch">Password didn't match.</span><br>
         <button class="btn btn-primary" 
         (click)="updatePassword(newPassword.value,rePassword.value,contactnum.value)">CHANGE PASSWORD</button><br>
         <span class="text-danger" *ngIf="passwordSyntax">{{errorMessage3}}</span>
         <span class="text-success" *ngIf="passwordUpdated">Password has been changed successfully. Dear{{username}}
 please login to continue.</span><br>
             </div>
    </p-dialog>
</section>
=======================================================================
import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { Router } from '@angular/router';
import { AuthService } from '../core/auth.service';
import { LoginService } from '../service/login.service';
import { Users } from '../models/User';

@Component({
  selector: 'app-login',
  templateUrl: './login.component.html',
  styleUrls: ['./login.component.css']
})
export class LoginComponent implements OnInit {
  registerPage: Boolean = false;
  loginForm: FormGroup;
  mismatch:boolean=false;
  passwordSyntax:boolean =false;

  errorMessage: string;
  errorMessage2: string;
  errorMessage3: string;

  showItenary: boolean = false;
  contactnum: string
  contactVal: boolean
  newPassword: string
  rePassword: string
  passwordUpdated: boolean = false;
  username: string
  user: Users = new Users();
  constructor(private fb: FormBuilder, private router: Router, private auth: AuthService, private loginservice: LoginService) { }

  ngOnInit() {

    this.loginForm = this.fb.group({
      contactNumber: ['', [Validators.required, Validators.pattern('^[0-9]{10}$')]],
      password: ['', [Validators.required]]
    })
  }
  login() {
    this.loginservice.login(this.loginForm.value).subscribe(
      (response) => {
        this.errorMessage = null;
        this.user = response;
        this.auth.nextUser(this.user);
        this.router.navigate(['/home'])

      },
      (errorResponse) => {
        //error message if invalid contact number or password
        this.errorMessage = errorResponse.error.message;
        sessionStorage.clear();
      }
    );
  }
  getRegisterPage() {
    this.registerPage = true;
    //open register page if the user is not registered already
    this.router.navigate(['/', 'register']);
  }
  getitenary() {
    //opens itenary if forgot password
    this.showItenary = true;
  }
  getContact(contactnum:string) {
   
    this.loginservice.contact(contactnum).subscribe(
      (response) => {
        this.errorMessage2 = null;
        this.username = response;
        this.auth.nextUser(this.user);
        this.contactVal = true
      },
      (errorResponse) => {
        //error message is shown if invaild contact no. is entered
        this.errorMessage2 =JSON.parse(errorResponse.error).message;
        sessionStorage.clear();
        this.contactVal = false;
      }
    )
  }
  updatePassword(contactno:string,newPassword:string,rePassword:string) {
    //Function to update contact no.
    if(newPassword!=null && rePassword!=null && newPassword==rePassword)
    {
      this.mismatch=false
    this.loginservice.update(contactno,newPassword).subscribe(
      (response) => {
        this.errorMessage3 = null;
        this.auth.nextUser(this.user);
        this.passwordUpdated = true;
      },
      (errorResponse) => {
        //error message is shown if invaild contact no. is entered
        this.errorMessage3 = errorResponse.error.message;
        sessionStorage.clear();
        this.passwordSyntax=true;

      }
    )
  }else{
    this.mismatch=true;
    this.passwordUpdated=false;
    this.passwordSyntax=false
  }
}
}
